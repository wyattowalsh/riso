# Implementation Plan: Expanded Documentation Template Options

**Branch**: `002-docs-template-expansion` | **Date**: 2025-10-29 | **Spec**: [/specs/002-docs-template-expansion/spec.md](./spec.md)

## Summary
Deliver three selectable documentation stacks—Fumadocs (Next.js 15 / Tailwind 4 default), Sphinx Shibuya, and Docusaurus 3.9 with DocSearch v4—plus a docs opt-out that strips automation. Hooks will auto-provision Node.js 20 and pnpm via mise, hydrate Python environments through uv, and fail fast when tooling cannot be installed. CI expands to regenerate every docs variant, publish artifacts via `actions/upload-artifact@v4`, and record governance metrics (including support-ticket variance and artifact-expiry warnings) without committing build outputs.

## Technical Context
- **Languages & Runtimes**: Python 3.11 (uv-managed), Node.js 20 LTS, TypeScript 5.6, POSIX shell hooks
- **Primary Dependencies**: Fumadocs v15, Sphinx 7.4 + Shibuya theme, Docusaurus 3.9 + DocSearch v4, pnpm ≥8, mise ≥2024.9, uv ≥0.4
- **Storage**: None (static documentation artifacts only)
- **Testing / Validation**: `uv run make docs`, `uv run make linkcheck`, `pnpm --filter docs-* lint/test`, Next.js static export, Docusaurus build, GitHub Actions docs smoke matrix
- **Target Platforms**: macOS 14+, Ubuntu 24.04 LTS, Windows Server 2022 GitHub runners
- **Performance Goals**: Variant docs build <8 min locally/CI; tooling auto-install <2 min; CI docs matrix <25 min wall clock
- **Constraints**: Hooks remain idempotent/offline aside from package registries; `.mise.toml` and `uv.lock` pin toolchains; docs artifacts uploaded only to CI
- **Scale / Scope**: Four prompt options (`fumadocs`, `sphinx-shibuya`, `docusaurus`, `none`); four smoke-tested samples; artifacts retained 90 days

## Constitution Check
- **Template Sovereignty**: Update template prompts, hooks, and docs payloads under `template/copier.yml`, `template/prompts/options.yml.jinja`, `template/hooks/*.py`, `template/files/{node,python,shared}/docs-*`; prove via regenerated samples and `copier diff`.
- **Deterministic Generation**: Extend `scripts/render-samples.sh`, `scripts/ci/render_matrix.py`, and `.github/workflows/template-ci.yml` to render each docs variant, execute smoke commands, upload artifacts, and capture metrics.
- **Minimal Baseline, Optional Depth**: Keep Fumadocs default lightweight; guard Shibuya/Docusaurus assets and dependencies behind prompts; ensure `docs_site=none` removes docs tooling entirely.
- **Documented Scaffolds**: Update `docs/quickstart.md.jinja`, `docs/modules/docs-site.md.jinja`, `docs/modules/sample-matrix.md.jinja`, `docs/modules/governance.md.jinja`, and `docs/upgrade-guide.md.jinja` with workflows, migrations, and evidence expectations.
- **Automation-Governed Compliance**: Require docs smoke jobs to pass, artifacts to publish, and `scripts/ci/track_doc_publish.py` to flag stale data before merge.

## Project Structure
```
specs/002-docs-template-expansion/
├── plan.md
├── research.md
├── data-model.md
├── quickstart.md
├── contracts/
│   └── toolchain_provisioning.schema.json
└── tasks.md  (generated by /speckit.tasks)

template/
├── copier.yml
├── prompts/options.yml.jinja
├── hooks/
│   ├── pre_gen_project.py
│   └── post_gen_project.py
├── files/
│   ├── node/docs/fumadocs/**
│   ├── node/docs/docusaurus/**
│   ├── python/docs/sphinx-shibuya/**
│   └── shared/docs/guidance/**
└── files/shared/.github/workflows/template-ci.yml.jinja

scripts/
├── render-samples.sh
└── ci/
    ├── render_matrix.py
    ├── run_baseline_quickstart.py
    ├── record_module_success.py
    └── track_doc_publish.py

samples/
├── default/
├── docs-fumadocs/
├── docs-sphinx/
└── docs-docusaurus/

.github/workflows/template-ci.yml
```

## Complexity Tracking
No constitutional deviations anticipated; optional variants remain prompt-gated and leverage existing automation pipelines.
