# Makefile.docs - Documentation build targets
# Generated by Riso template for {{ project_name }}
# Feature: 018-docs-sites-overhaul

SPHINXOPTS    ?=
SPHINXBUILD   ?= sphinx-build
SOURCEDIR     = docs
BUILDDIR      = _build

.PHONY: help docs linkcheck doctest clean-docs

help:
	@echo "Documentation build targets:"
	@echo "  docs       Build HTML documentation"
	@echo "  linkcheck  Check all external links"
	@echo "  doctest    Run doctests in documentation"
	@echo "  clean-docs Clean documentation build artifacts"

docs:
	@echo "Building Sphinx documentation..."
	@$(SPHINXBUILD) -M html "$(SOURCEDIR)" "$(BUILDDIR)" $(SPHINXOPTS)
	@echo "✅ Documentation built successfully!"
	@echo "Open $(BUILDDIR)/html/index.html to view."

linkcheck:
	@echo "Checking external links (with retry logic)..."
	@$(SPHINXBUILD) -M linkcheck "$(SOURCEDIR)" "$(BUILDDIR)" $(SPHINXOPTS)
	@echo "✅ Link check complete. See $(BUILDDIR)/linkcheck/output.txt for details."

doctest:
	@echo "Running doctests..."
	@$(SPHINXBUILD) -M doctest "$(SOURCEDIR)" "$(BUILDDIR)" $(SPHINXOPTS)

clean-docs:
	@echo "Cleaning documentation build artifacts..."
	@rm -rf $(BUILDDIR)/*
	@echo "✅ Documentation artifacts cleaned."
